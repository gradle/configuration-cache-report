The `:configuration-cache-report` project produces the Javascript / HTML
app for browsing and understanding problems occurred when running a
build with configuration caching.

The output of `:configuration-cache-report` is completely produced by the
`assembleReport` task into `build/report` which then gets published to repo.grdev.net.
It's consumed by `gradle/gradle`'s
[`configuration-problems-base` module](https://github.com/gradle/gradle/tree/master/platforms/core-configuration/configuration-problems-base).

## Architecture

The interface between `:configuration-cache` and
`:configuration-cache-report` is a Javascript global function named
`configurationCacheProblems` which must be defined in a file named
`configuration-cache-report-data.js`. The file is generated by the
`:configuration-cache` module from the data collected at configuration
time.

An [example file](./src/jsMain/resources/configuration-cache-report-data.js)
is kept for documentation and testing purposes.

The app itself is built according to
[the Elm architecture](https://guide.elm-lang.org/architecture/).

## Setting up a quick feedback loop

Run in development mode with Kotlin sources in the browser debugger:

```shell
./gradlew :jsBrowserDevelopmentRun
```

Add live-reload by using Gradle's continuous mode:

```shell
./gradlew :jsBrowserDevelopmentRun --continuous
```

## Development with `gradle/gradle` and composite build

To quickly make and verify changes for `gradle/gradle` build, you can run
(this assumes you have cloned `configuration-cache-report` in the same directory as `gradle`):

```
./gradlew <TheTaskToBeRunInGradleBuild> --include-build ../configuration-cache-report -Dorg.gradle.dependency.verification=lenient
```

## Releasing

Release steps:

1. Update the report version in `gradle.properties` (via the `configuration-cache-report.version` property) to remove the `-SNAPSHOT` suffix in preparation for the release
2. Publish the report to the internal repository by running this [TeamCity job](https://builds.gradle.org/buildConfiguration/Gradle_ConfigurationCacheReport_Publish) (on the default branch)
3. Check that the publishing was successful and the artifacts are [present in the internal repository](https://repo.grdev.net/ui/repos/tree/General/public/org/gradle/buildtool/internal/configuration-cache-report)
4. Update the [report version](https://github.com/gradle/gradle/blob/master/build-logic/dependency-modules/src/main/kotlin/gradlebuild/modules/extension/ExternalModulesExtension.kt#L29) in `gradle/gradle` repository
5. Increment the report version in `gradle.properties` (via the `configuration-cache-report.version` property) and add the `-SNAPSHOT` suffix back in preparation for the next development cycle
